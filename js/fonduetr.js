const fondueTranslations = {
    fr: {
        // Menu
        "Fondue Chinoise": "Fondue Chinoise",
        "Formules": "Formules",
        "Viandes & Fruits de mer": "Viandes & Fruits de mer",
        "Légumes & Féculents": "Légumes & Féculents",
        "Produit": "Produit",
        "Prix": "Prix",
        
        // Formules
        "Formule Bouillon 'Tub Bone Casserole'": "Formule Bouillon 'Casserole à os'",
        "Formule Bouillon 'Choucroute de Poisson'": "Formule Bouillon 'Poisson à la choucroute'",
        "Bouillon maison composé de : os, carottes, tomates, feuilles de tofu au porc": "Bouillon maison composé de : os, carottes, tomates, feuilles de tofu au porc",
        "Bouillon maison à base de poisson et choucroute": "Bouillon maison à base de poisson et choucroute",
        
        // Viandes
        "Os": "Os",
        "Tranches de bœuf": "Tranches de bœuf",
        "Tranches d'agneau": "Tranches d'agneau",
        "Bœuf mariné épicé": "Bœuf mariné épicé",
        "Calamar": "Calamar",
        "Jambon tranchés": "Jambon de bœuf en tranches",
        "Tripes": "Tripes",
        "Sang en gelée de porc": "Sang de porc",
        "Intestins de seiche": "Intestins de seiche",
        "Boules de sèche": "Boules de seiche",
        "Boules de porc": "Boules de porc",
        "Boulettes de bœuf": "Boulettes de bœuf",
        "Assortiment de boules": "Assortiment de boulettes",
        "Raviolis feuilles de tofu au porc": "Raviolis en feuille de tofu au porc",
        "Filet de morue épicé": "Filet de morue épicé",
        "Crevettes": "Crevettes",
        "Tranche de bar": "Tranche de bar",
        "Chair de crevette": "Pâte de crevette",
        "Raviolis œufs au porc": "Raviolis aux œufs et porc",
        
        // Légumes
        "Assortiment de champignons": "Assortiment de champignons",
        "Assortiment de légumes": "Assortiment de légumes",
        "Assortiment de produits à base de soja": "Assortiment de produits au soja",
        "Algues": "Algues",
        "Collybie à pied velouté": "Collybie à pied velouté",
        "Champignons shiitake": "Champignons shiitake",
        "Tranches de pomme de terre": "Tranches de pomme de terre",
        "Concombres": "Concombres",
        "Tofu": "Tofu",
        "Rouleaux de tofu séché": "Rouleaux de tofu séché",
        "Feuilles de tofu": "Feuilles de tofu",
        "Vermicelles": "Vermicelles",
        "Chou chinois": "Chou chinois",
        "Pousses de soja": "Pousses de soja",
        "Salades": "Salades",
        "Coriandre": "Coriandre",
        "Tranches de racine de lotus": "Tranches de racine de lotus",
        "Champignons noirs": "Champignons noirs",
        "Nouilles ou nouilles de riz": "Nouilles ou nouilles de riz",
        "Wontons": "Wontons"
    },
    en: {
        // Menu
        "Fondue Chinoise": "Chinese Hot Pot",
        "Formules": "Set Menus",
        "Viandes & Fruits de mer": "Meats & Seafood",
        "Légumes & Féculents": "Vegetables & Starches",
        "Produit": "Product",
        "Prix": "Price",
        
        // Formules
        "Formule Bouillon 'Tub Bone Casserole'": "'Bone Marrow' Hot Pot Set",
        "Formule Bouillon 'Choucroute de Poisson'": "'Pickled Fish' Hot Pot Set",
        "Bouillon maison composé de : os, carottes, tomates, feuilles de tofu au porc": "Homemade broth with: bones, carrots, tomatoes, tofu skin with pork",
        "Bouillon maison à base de poisson et choucroute": "Homemade fish broth with sauerkraut",
        
        // Viandes
        "Os": "Bones",
        "Tranches de bœuf": "Beef slices",
        "Tranches d'agneau": "Lamb slices",
        "Bœuf mariné épicé": "Spicy marinated beef",
        "Calamar": "Squid",
        "Jambon tranchés": "Beef ham slices",
        "Tripes": "Beef tripe",
        "Sang en gelée de porc": "Pork blood",
        "Intestins de seiche": "Cuttlefish intestines",
        "Boules de sèche": "Cuttlefish balls",
        "Boules de porc": "Pork meatballs",
        "Boulettes de bœuf": "Beef meatballs",
        "Assortiment de boules": "Assorted meatballs",
        "Raviolis feuilles de tofu au porc": "Tofu skin pork dumplings",
        "Filet de morue épicé": "Spicy cod fillet",
        "Crevettes": "Fresh shrimps",
        "Tranche de bar": "Sea bass slice",
        "Chair de crevette": "Shrimp paste",
        "Raviolis œufs au porc": "Egg pork dumplings",
        
        // Légumes
        "Assortiment de champignons": "Mushroom platter",
        "Assortiment de légumes": "Vegetable platter",
        "Assortiment de produits à base de soja": "Soy products platter",
        "Algues": "Seaweed",
        "Collybie à pied velouté": "Enoki mushrooms",
        "Champignons shiitake": "Shiitake mushrooms",
        "Tranches de pomme de terre": "Potato slices",
        "Concombres": "Cucumbers",
        "Tofu": "Tofu",
        "Rouleaux de tofu séché": "Dried tofu rolls",
        "Feuilles de tofu": "Tofu sheets",
        "Vermicelles": "Vermicelli noodles",
        "Chou chinois": "Chinese cabbage",
        "Pousses de soja": "Bean sprouts",
        "Salades": "Lettuce",
        "Coriandre": "Cilantro",
        "Tranches de racine de lotus": "Lotus root slices",
        "Champignons noirs": "Black fungus",
        "Nouilles ou nouilles de riz": "Noodles or rice noodles",
        "Wontons": "Wontons"
    },
    zh: {
        // Menu
        "Fondue Chinoise": "中式火锅",
        "Formules": "套餐",
        "Viandes & Fruits de mer": "肉类和海鲜",
        "Légumes & Féculents": "蔬菜和主食",
        "Produit": "产品",
        "Prix": "价格",
        
        // Formules
        "Formule Bouillon 'Tub Bone Casserole'": "筒骨火锅套餐",
        "Formule Bouillon 'Choucroute de Poisson'": "酸菜鱼火锅套餐",
        "Bouillon maison composé de : os, carottes, tomates, feuilles de tofu au porc": "自制汤底含：筒骨、胡萝卜、番茄、百叶包猪肉",
        "Bouillon maison à base de poisson et choucroute": "自制酸菜鱼汤底",
        
        // Viandes
        "Os": "骨头",
        "Tranches de bœuf": "牛肉卷",
        "Tranches d'agneau": "羊肉卷",
        "Bœuf mariné épicé": "麻辣牛肉",
        "Calamar": "鱿鱼卷",
        "Jambon tranchés": "牛餐肉",
        "Tripes": "牛百叶",
        "Sang en gelée de porc": "猪血",
        "Intestins de seiche": "肥肠",
        "Boules de sèche": "墨鱼丸",
        "Boules de porc": "包心贡丸",
        "Boulettes de bœuf": "牛肉丸",
        "Assortiment de boules": "丸子拼盘",
        "Raviolis feuilles de tofu au porc": "鲜肉百叶包",
        "Filet de morue épicé": "麻辣鳕鱼片",
        "Crevettes": "新鲜大虾",
        "Tranche de bar": "鲜鲈鱼片",
        "Chair de crevette": "虾滑",
        "Raviolis œufs au porc": "蛋饺",
        
        // Légumes
        "Assortiment de champignons": "菌菇拼盘",
        "Assortiment de légumes": "蔬菜拼盘",
        "Assortiment de produits à base de soja": "豆制品拼盘",
        "Algues": "海带结",
        "Collybie à pied velouté": "金针菇",
        "Champignons shiitake": "香菇",
        "Tranches de pomme de terre": "土豆片",
        "Concombres": "黄瓜",
        "Tofu": "鲜豆腐",
        "Rouleaux de tofu séché": "腐竹",
        "Feuilles de tofu": "厚千张豆腐",
        "Vermicelles": "粉丝",
        "Chou chinois": "白菜",
        "Pousses de soja": "豆芽",
        "Salades": "生菜",
        "Coriandre": "香菜",
        "Tranches de racine de lotus": "藕片",
        "Champignons noirs": "黑木耳",
        "Nouilles ou nouilles de riz": "面条/米线",
        "Wontons": "馄饨"
    }
};

document.addEventListener('DOMContentLoaded', () => {
    console.log('Fondue JS loaded');
    
    try {
        // Données COMPLÈTES du menu
        const menuData = {
            formules: [
                { 
                    name: "Formule Bouillon 'Tub Bone Casserole'", 
                    description: "Bouillon maison composé de : os, carottes, tomates, feuilles de tofu au porc", 
                    price: "25,80 €",
                    highlight: false
                },
                { 
                    name: "Formule Bouillon 'Choucroute de Poisson'", 
                    description: "Bouillon maison à base de poisson et choucroute", 
                    price: "34,80 €",
                    highlight: true 
                }
            ],
            viandes: [
                { name: "Os", price: "6,90 €" },
                { name: "Tranches de bœuf", price: "5,90 €" },
                { name: "Tranches d'agneau", price: "5,90 €" },
                { name: "Bœuf mariné épicé", price: "9,90 €" },
                { name: "Calamar", price: "9,90 €" },
                { name: "Jambon tranchés", price: "6,90 €" },
                { name: "Tripes", price: "6,90 €" },
                { name: "Sang en gelée de porc", price: "6,90 €" },
                { name: "Intestins de seiche", price: "6,90 €" },
                { name: "Boules de sèche", price: "9,90 €" },
                { name: "Boules de porc", price: "9,90 €" },
                { name: "Boulettes de bœuf", price: "9,90 €" },
                { name: "Assortiment de boules", price: "9,90 €" },
                { name: "Raviolis feuilles de tofu au porc", price: "9,90 €" },
                { name: "Filet de morue épicé", price: "9,90 €" },
                { name: "Crevettes", price: "14,90 €" },
                { name: "Tranche de bar", price: "16,90 €" },
                { name: "Chair de crevette", price: "9,90 €" },
                { name: "Raviolis œufs au porc", price: "9,90 €" }
            ],
            legumes: [
                { name: "Assortiment de champignons", price: "12,90 €" },
                { name: "Assortiment de légumes", price: "7,90 €" },
                { name: "Assortiment de produits à base de soja", price: "12,90 €" },
                { name: "Algues", price: "4,90 €" },
                { name: "Collybie à pied velouté", price: "5,90 €" },
                { name: "Champignons shiitake", price: "4,90 €" },
                { name: "Tranches de pomme de terre", price: "4,90 €" },
                { name: "Concombres", price: "4,90 €" },
                { name: "Tofu", price: "4,90 €" },
                { name: "Rouleaux de tofu séché", price: "4,90 €" },
                { name: "Feuilles de tofu", price: "4,90 €" },
                { name: "Vermicelles", price: "4,90 €" },
                { name: "Chou chinois", price: "4,90 €" },
                { name: "Pousses de soja", price: "4,90 €" },
                { name: "Salades", price: "4,90 €" },
                { name: "Coriandre", price: "4,90 €" },
                { name: "Tranches de racine de lotus", price: "4,90 €" },
                { name: "Champignons noirs", price: "4,90 €" },
                { name: "Nouilles ou nouilles de riz", price: "5,90 €" },
                { name: "Wontons", price: "5,90 €" }
            ]
        };

        // Génération des formules
        const generateFormules = () => {
            const container = document.getElementById('formules-container');
            if (!container) return;

            container.innerHTML = '';
            
            menuData.formules.forEach(formule => {
                const formuleLine = document.createElement('div');
                formuleLine.className = `formule-line ${formule.highlight ? 'highlight' : ''}`;
                
                const descriptionHtml = formule.description 
                    ? `<br><small data-translate="${formule.description}">${formule.description}</small>` 
                    : '';
                
                formuleLine.innerHTML = `
                    <span class="formule-combo">
                        <span data-translate="${formule.name}">${formule.name}</span>
                        ${descriptionHtml}
                    </span>
                    <span class="formule-price">${formule.price}</span>
                `;
                
                container.appendChild(formuleLine);
            });
        };

        // Génération des tables
        const generateTable = (categoryId, items) => {
            const section = document.getElementById(categoryId);
            if (!section) return;
            
            section.innerHTML = '';
            
            const table = document.createElement('table');
            table.className = 'fondue-table';
            
            const thead = document.createElement('thead');
            thead.innerHTML = `
                <tr>
                    <th data-translate="Produit">Produit</th>
                    <th data-translate="Prix">Prix</th>
                </tr>
            `;
            
            const tbody = document.createElement('tbody');
            items.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td data-translate="${item.name}">${item.name}</td>
                    <td>${item.price}</td>
                `;
                tbody.appendChild(row);
            });
            
            table.appendChild(thead);
            table.appendChild(tbody);
            section.appendChild(table);
        };

        // Fonction de traduction
        const updateTranslations = (lang) => {
            const translations = fondueTranslations[lang] || fondueTranslations.fr;
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[key]) {
                    element.textContent = translations[key];
                }
            });
        };

        // Gestion du changement de langue
        const setupLanguageSwitcher = () => {
            const languageBtns = document.querySelectorAll('.language-btn');
            
            languageBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.getAttribute('data-lang');
                    languageBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    updateTranslations(lang);
                });
            });
        };

        // Initialisation
        generateFormules();
        generateTable('viandes-grid', menuData.viandes);
        generateTable('legumes-grid', menuData.legumes);
        setupLanguageSwitcher();
        updateTranslations('fr');

        // Animation des éléments
        const animateElements = () => {
            const elements = document.querySelectorAll('.formule-line, .fondue-table tr');
            elements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'all 0.5s ease';
                
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, 100 + (index * 50));
            });
        };

        setTimeout(animateElements, 300);

    } catch (error) {
        console.error('Error in fondue.js:', error);
    }
});
